<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />
    <title>Example 2 - Mollie Components</title>
    <link rel="stylesheet" href="/base.css" />
    <link rel="stylesheet" href="/example2/style.css" />
  </head>
  <body>

    <div class="wrapper">
      <form method="post" class="form" id="mcForm">
        <div class="form-fields">
          <div id="card-holder-group" class="form-group form-group--cardHolder">
            <label class="label" for="card-holder">Card holder</label>
            <div id="card-holder"></div>
            <div id="card-holder-errors" class="field-error" role="alert"></div>
          </div>

          <div class="form-group form-group--cardNumber">
            <label class="label" for="card-number">Card number</label>
            <div id="card-number"></div>
            <div id="card-number-errors" class="field-error" role="alert"></div>
          </div>

          <div class="form-group form-group--expiryDate">
            <label class="label" for="expiry-date">Expiry date</label>
            <div id="expiry-date"></div>
            <div id="expiry-date-errors" class="field-error" role="alert"></div>
          </div>

          <div class="form-group form-group--verificationCode">
            <label class="label" for="verification-code">Verification code</label>
            <div id="verification-code"></div>
            <div id="verification-code-errors" class="field-error" role="alert"></div>
          </div>
        </div>

        <button id="submit-button" class="submit-button" type="submit">
          Pay
        </button>

        <div id="form-errors" class="form-errors" role="alert"></div>
      </form>
    </div>

    <script src="https://js.mollie.com/v1/mollie.js"></script>
    <script src="/script.js"></script>
    <script>
      /**
       * Observing the classList changes on the Mollie Components elements
       * so we can set the correct classes on the parent elements. This
       * is needed specifically for the floating labels in this example.
       */
      (function() {
        const classListObserver = new MutationObserver(mutations => {
          mutations.forEach(mutation => {
            const el = mutation.target;
            if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
              if (!mutation.target || !mutation.target.classList) {
                return;
              }

              const hasFocus = mutation.target.classList.contains('has-focus');
              const isTouched = mutation.target.classList.contains('is-touched');
              const isInvalid = mutation.target.classList.contains('is-invalid');

              mutation.target.parentNode.parentNode.classList.toggle('has-focus', hasFocus);
              mutation.target.parentNode.parentNode.classList.toggle('is-touched', isTouched);
              mutation.target.parentNode.parentNode.classList.toggle('is-invalid', isInvalid);
            }
          })
        });

        const cardHolderComponent = document.querySelector('#card-holder .mollie-component');
        const cardNumberComponent = document.querySelector('#card-number .mollie-component');
        const expiryDateComponent = document.querySelector('#expiry-date .mollie-component');
        const verificationCodeComponent = document.querySelector('#verification-code .mollie-component');

        classListObserver.observe(cardHolderComponent, { attributes: true });
        classListObserver.observe(cardNumberComponent, { attributes: true });
        classListObserver.observe(expiryDateComponent, { attributes: true });
        classListObserver.observe(verificationCodeComponent, { attributes: true });
      })();
    </script>
  </body>
</html>
